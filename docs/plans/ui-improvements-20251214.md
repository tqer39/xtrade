# UI改善計画 (2024-12-14)

## 概要

トップページ、マイページ、アイテム詳細ページのUIを改善する。

---

## 修正項目

### 1. ヘッダーのユーザー表示改善

**対象**: `src/components/auth/user-menu.tsx`

**現状**: 表示名（Takeru O'oyama）のみ表示。
**変更**: 表示名の下に Twitter アイコンと Twitter ID（@tqer39）を表示。

---

### 2. トップページのホバー時に出品者の欲しいものを表示

**対象**: `app/_components/card-list-item.tsx`

**変更内容**:

- カード画像にマウスホバー時、出品者の「欲しいもの」リストをオーバーレイ表示。
- 出品者と何のアイテムなら交換できるかを一目でわかるようにする。

**データ取得**:

- 既存の `/api/cards` または `/api/cards/latest` から `owner.wantCards` を返すよう拡張。

---

### 3. トップページからアイテム詳細ページへの遷移

**対象**: `app/_components/card-list-item.tsx`

**現状**: モーダル表示（URLは変わらない）。
**変更**: `/items/[itemId]` ページへ遷移するよう変更。

---

### 4. URL のページング対応

**対象**: 全ページ。

**変更内容**:

- ページングは `?p=N` のクエリパラメーターで表現。
- ブラウザの「戻る」で正しくナビゲート可能に。
- `next/prev` のナビゲーションを各ページで統一的に実装。

---

### 5. URL の card → item への修正

**対象**:

- `app/cards/` → `app/items/`
- `app/api/cards/` → `app/api/items/`
- 各種リンク、コンポーネント内の参照

**注意**: DB スキーマの `card` テーブル名はそのまま（影響範囲が大きいため）。

---

### 6. アイテム詳細ページに出品者の欲しいもの表示

**対象**: `app/items/[itemId]/page.tsx`（リネーム後）

**変更内容**:

- 出品者情報セクションに「欲しいもの」リストを表示。
- カード詳細画面の出品者情報と同様の表示。

---

### 7. ユーザーページのヘッダー位置修正

**対象**: `app/users/[userId]/_components/user-profile-client.tsx`

**現状**: 左に「戻る」、右に「xtrade」。
**変更**: 左に「xtrade」、右に「戻る」に修正。

---

### 8. レビュー機能のプライバシー対応

**対象**:

- `app/users/[userId]/_components/user-profile-client.tsx`
- `app/api/users/[userId]/reviews/route.ts`（必要に応じて作成）

**変更内容**:

- 取引完了後、取引相手に対してのみレビュー可能（アイテムへのレビューは不可）。
- 自分のレビュータブ: 自分が誰にどのような評価をしたか参照可能。
- 他人のレビュータブ: 非表示（または「レビューは非公開です」と表示）。

---

## 実装順序

1. URL の card → item への修正（影響範囲が大きいため先に実施）。
2. ヘッダーのユーザー表示改善。
3. ユーザーページのヘッダー位置修正。
4. レビュー機能のプライバシー対応。
5. トップページのホバー時に出品者の欲しいもの表示。
6. トップページからアイテム詳細ページへの遷移。
7. アイテム詳細ページに出品者の欲しいもの表示。
8. URL のページング対応。
9. lint確認。

---

## 対象ファイル一覧

| ファイル | 変更内容 |
| --------- | --------- |
| `app/cards/` | `app/items/` へリネーム |
| `app/api/cards/` | `app/api/items/` へリネーム |
| `src/components/auth/user-menu.tsx` | Twitter ID 表示追加 |
| `app/users/[userId]/_components/user-profile-client.tsx` | ヘッダー位置修正、レビュープライバシー |
| `app/_components/card-list-item.tsx` | ホバー表示、リンク先変更 |
| 各種コンポーネント | card → item のリンク修正 |
